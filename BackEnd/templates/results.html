<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Flight Delay Tracker</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro"/>
    <link rel="stylesheet" type="text/css" href="../static/css/flapper.css"/>
    
    <style>
        body {
            background-image: url("/static/photo3.jpeg");
                             background-size: cover;
                             -webkit-background-size: cover;
                             -moz-background-size: cover;
                             -o-background-size: cover;
                            background-repeat: no-repeat;
                             background-attachment: fixed;
                             background-position: center;
        }
    </style>

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <script src="../static/js/jquery.transform-0.9.3.min.js"></script>
    <script src="../static/js/jshashtable.js"></script>
    <script src="../static/js/jquery.flapper.js"></script>
    <script src="../static/js/moment.js"></script>
    <script type="text/javascript">
      $(document).ready(function () { // do this when page loads

        // define options for date/time flappers

        var dateOptions = {
          width: 6,
          chars_preset: 'alphanum'
        }

        var timeOptions = {
          width: 6,
          chars_preset: 'num'
        }

        // declare variables to hold data from back end {{delay_times}} = [min, avg, max]; {{dep_datetime}} = 'yyyy-mm-dd hh:mm:ss';

        var delay_times = {{ delay_times }};
        var dep_datetime = '{{dep_datetime | string}}';

        // processes {{dep_datetime}} using {{delay_times}} formats date/time and passes to flappers as string change() starts the animation

        for (var i = 0; i < 3; i++) {
          var flapperDatetime = moment(dep_datetime).add(delay_times[i], 'm');
          var depDate = flapperDatetime.format("MMM DD").toUpperCase();
          var depTime = flapperDatetime.format("HH:mm");
          $('#datedisplay' + i).flapper(dateOptions).val(depDate).change();
          $('#timedisplay' + i).flapper(dateOptions).val(depTime).change();
        }

        $('#flight').html('{{ flight }}');
        $('#origin').html('{{ origin }}');
        $('#destination').html('{{ dest }}');
        $('#date').html(moment(dep_datetime).format("MMM DD, YYYY"));
      });
    </script>
  </head>
  <body>
    <div class="container">
      {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul class=flashes>
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
      {% endwith %}
      <div class="row" id="results-header">
        <center>
          <h2>Estimated Times of Departure</h2>
          <p>DISCLAIMER: All estimates are approximate only.</p>
        </center>
      </div>
      <div style="height: 20px;"></div>
      <div class="row" id="results-flight-details">
        <div class="col-md-3 col-md-offset-2">
          <p>
            <b>Flight Number</b>:
            <span class="value" id="flight"></span>
        </p>
      </div>
      <div class="col-md-3">
        <p>
          <b>Route</b>:
          <b>
            <span class="value" id="origin"></span>
          </b>
          to
          <b>
            <span class="value" id="destination"></span>
          </b>
        </p>
      </div>
      <div class="col-md-3">
        <p>
          <b>Date</b>:
          <span class="value" id="date"></span>
        </p>
      </div>
    </div>

    <div class="col-md-3 col-md-offset-2">
      <input class="header light XS" id="datedisplay0"/>
      <input class="header light XS" id="timedisplay0"/>
      <p>
        <b>Best Case</b>
      </p>
    </div>
    <div class="col-md-3">
      <input class="header light XS" id="datedisplay1"/>
      <input class="header light XS" id="timedisplay1"/>
      <p>
        <b>Realistic</b>
      </p>
    </div>
    <div class="col-md-3">
      <input class="header light XS" id="datedisplay2"/>
      <input class="header light XS" id="timedisplay2"/>
      <p>
        <b>Worst Case</b>
      </p>
    </div>
  </div>
</div>
</body>
</html>
